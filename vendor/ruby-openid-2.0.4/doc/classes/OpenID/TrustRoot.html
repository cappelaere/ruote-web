<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: OpenID::TrustRoot</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">OpenID::TrustRoot</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/openid/trustroot_rb.html">
                lib/openid/trustroot.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000269">_extract_return_url</a>&nbsp;&nbsp;
      <a href="#M000271">get_allowed_return_urls</a>&nbsp;&nbsp;
      <a href="#M000270">return_to_matches</a>&nbsp;&nbsp;
      <a href="#M000272">verify_return_to</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="TrustRoot/TrustRoot.html" class="link">OpenID::TrustRoot::TrustRoot</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TOP_LEVEL_DOMAINS</td>
          <td>=</td>
          <td class="context-item-value">%w'       com edu gov int mil net org biz info name museum coop aero ac ad       ae af ag ai al am an ao aq ar as at au aw az ba bb bd be bf bg       bh bi bj bm bn bo br bs bt bv bw by bz ca cc cd cf cg ch ci ck       cl cm cn co cr cu cv cx cy cz de dj dk dm do dz ec ee eg eh er       es et eu fi fj fk fm fo fr ga gd ge gf gg gh gi gl gm gn gp gq       gr gs gt gu gw gy hk hm hn hr ht hu id ie il im in io iq ir is       it je jm jo jp ke kg kh ki km kn kp kr kw ky kz la lb lc li lk       lr ls lt lu lv ly ma mc md mg mh mk ml mm mn mo mp mq mr ms mt       mu mv mw mx my mz na nc ne nf ng ni nl no np nr nu nz om pa pe       pf pg ph pk pl pm pn pr ps pt pw py qa re ro ru rw sa sb sc sd       se sg sh si sj sk sl sm sn so sr st sv sy sz tc td tf tg th tj       tk tm tn to tp tr tt tv tw tz ua ug uk um us uy uz va vc ve vg       vi vn vu wf ws ye yt yu za zm zw'</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ALLOWED_PROTOCOLS</td>
          <td>=</td>
          <td class="context-item-value">['http', 'https']</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">RP_RETURN_TO_URL_TYPE</td>
          <td>=</td>
          <td class="context-item-value">'http://specs.openid.net/auth/2.0/return_to'</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The URI for relying party discovery, used in realm verification.

<p>
XXX: This should probably live somewhere else (like in <a
href="../OpenID.html">OpenID</a> or <a href="Yadis.html">OpenID::Yadis</a>
somewhere)
</p>
</td>
        </tr>
        </table>
      </div>
    </div>



      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000269" class="method-detail">
        <a name="M000269"></a>

        <div class="method-heading">
          <a href="TrustRoot.src/M000269.html" target="Code" class="method-signature"
            onclick="popupCode('TrustRoot.src/M000269.html');return false;">
          <span class="method-name">_extract_return_url</span><span class="method-args">(endpoint)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
If the endpoint is a relying party <a href="../OpenID.html">OpenID</a>
return_to endpoint, return the endpoint URL. Otherwise, return None.
</p>
<p>
This function is intended to be used as a filter for the <a
href="Yadis.html">Yadis</a> filtering interface.
</p>
<p>
endpoint: An XRDS BasicServiceEndpoint, as returned by performing <a
href="Yadis.html">Yadis</a> dicovery.
</p>
<p>
returns the endpoint URL or None if the endpoint is not a relying party
endpoint.
</p>
        </div>
      </div>

      <div id="method-M000271" class="method-detail">
        <a name="M000271"></a>

        <div class="method-heading">
          <a href="TrustRoot.src/M000271.html" target="Code" class="method-signature"
            onclick="popupCode('TrustRoot.src/M000271.html');return false;">
          <span class="method-name">get_allowed_return_urls</span><span class="method-args">(relying_party_url)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Given a relying party discovery URL return a list of return_to URLs.
</p>
        </div>
      </div>

      <div id="method-M000270" class="method-detail">
        <a name="M000270"></a>

        <div class="method-heading">
          <a href="TrustRoot.src/M000270.html" target="Code" class="method-signature"
            onclick="popupCode('TrustRoot.src/M000270.html');return false;">
          <span class="method-name">return_to_matches</span><span class="method-args">(allowed_return_to_urls, return_to)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Is the return_to URL under one of the supplied allowed return_to URLs?
</p>
        </div>
      </div>

      <div id="method-M000272" class="method-detail">
        <a name="M000272"></a>

        <div class="method-heading">
          <a href="TrustRoot.src/M000272.html" target="Code" class="method-signature"
            onclick="popupCode('TrustRoot.src/M000272.html');return false;">
          <span class="method-name">verify_return_to</span><span class="method-args">(realm_str, return_to, _vrfy=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Verify that a return_to URL is valid for the given realm.
</p>
<p>
This function builds a discovery URL, performs <a
href="Yadis.html">Yadis</a> discovery on it, makes sure that the URL does
not redirect, parses out the return_to URLs, and finally checks to see if
the current return_to URL matches the return_to.
</p>
<p>
raises <a href="DiscoveryFailure.html">DiscoveryFailure</a> when <a
href="Yadis.html">Yadis</a> discovery fails returns true if the return_to
URL is valid for the realm
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>